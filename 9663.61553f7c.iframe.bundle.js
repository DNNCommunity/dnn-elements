"use strict";(self.webpackChunk_dnncommunity_dnn_elements=self.webpackChunk_dnncommunity_dnn_elements||[]).push([[9663],{"./dist/esm/debounce-0977f95e.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function Debounce(debounceTime=500){return function(_target,_key,descriptor){let originalMethod=descriptor.value,timer=null;descriptor.value=function(...args){return clearTimeout(timer),new Promise((resolve=>{timer=setTimeout((()=>{resolve(originalMethod.apply(this,args))}),debounceTime)}))}}}__webpack_require__.d(__webpack_exports__,{D:()=>Debounce})},"./dist/esm/dnn-autocomplete.entry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{dnn_autocomplete:()=>DnnAutocomplete});var _index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./dist/esm/index-9dbb7028.js"),_debounce_0977f95e_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./dist/esm/debounce-0977f95e.js");var __decorate=function(decorators,target,key,desc){var d,c=arguments.length,r=c<3?target:null===desc?desc=Object.getOwnPropertyDescriptor(target,key):desc;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(decorators,target,key,desc);else for(var i=decorators.length-1;i>=0;i--)(d=decorators[i])&&(r=(c<3?d(r):c>3?d(target,key,r):d(target,key))||r);return c>3&&r&&Object.defineProperty(target,key,r),r};const DnnAutocomplete=class{constructor(hostRef){(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,hostRef),this.valueChange=(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"valueChange",7),this.valueInput=(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"valueInput",7),this.needMoreItems=(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"needMoreItems",7),this.searchQueryChanged=(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"searchQueryChanged",7),this.itemSelected=(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"itemSelected",7),hostRef.$hostElement$["s-ei"]?this.internals=hostRef.$hostElement$["s-ei"]:(this.internals=hostRef.$hostElement$.attachInternals(),hostRef.$hostElement$["s-ei"]=this.internals),this.adjustDropdownPosition=()=>{var itemHeight=this.findAverageSuggestionHeight();requestAnimationFrame((()=>{this.positionInitialized=!0}));var spaceBelow=window.innerHeight-this.inputField.getBoundingClientRect().bottom;const rem=parseFloat(getComputedStyle(document.documentElement).fontSize),fitsDown=spaceBelow>3*itemHeight+3*rem;fitsDown?this.suggestionsContainer.style.top="1.2rem":this.suggestionsContainer.style.bottom="1.2rem",this.suggestionsContainer.style.maxHeight=fitsDown?spaceBelow-3*rem+"px":this.inputField.getBoundingClientRect().top-3*rem+"px",this.checkIfMoreItemsNeeded()},this.label=void 0,this.name=void 0,this.helpText=void 0,this.value=void 0,this.required=void 0,this.disabled=void 0,this.suggestions=[],this.renderSuggestion=void 0,this.totalSuggestions=void 0,this.preloadThresholdPixels=1e3,this.focused=!1,this.valid=!0,this.customValidityMessage=void 0,this.selectedIndex=void 0,this.positionInitialized=!1,this.lastScrollTop=0}async checkValidity(){return this.inputField.validity}async setCustomValidity(message){if(null==message||""==message)return this.inputField.setCustomValidity(""),this.valid=!0,void this.fieldset.setValidity(!0);this.inputField.setCustomValidity(message),this.valid=!1,this.fieldset.setValidity(!1,message)}handleOutsideClick(e){e.composedPath().includes(this.element)||(this.focused=!1)}componentDidRender(){this.focused&&this.suggestions.length>0&&!this.positionInitialized&&this.adjustDropdownPosition()}formResetCallback(){this.inputField.setCustomValidity(""),this.valid=!0,this.value="",this.internals.setValidity({}),this.internals.setFormValue("")}handleInput(e){const value=e.target.value;var valid=this.inputField.checkValidity();this.valid=valid,this.valueInput.emit(value),this.handleSearchQueryChanged(value)}handleSearchQueryChanged(value){this.searchQueryChanged.emit(value)}handleInvalid(){this.valid=!1,null==this.customValidityMessage&&(this.customValidityMessage=this.inputField.validationMessage)}handleChange(){if(this.valueChange.emit(this.value),null!=this.name){var data=new FormData;data.append(this.name,this.value.toString()),this.internals.setFormValue(data)}}shouldLabelFloat(){return!this.focused&&(null==this.value||""==this.value)}findAverageSuggestionHeight(){const suggestionItems=this.suggestionsContainer.querySelectorAll("li");var totalHeight=0;for(let i=0;i<suggestionItems.length;i++)totalHeight+=suggestionItems[i].clientHeight;return totalHeight/suggestionItems.length}handleKeyDown(e){var _a;if("ArrowDown"===e.key&&(e.preventDefault(),null==this.selectedIndex?this.selectedIndex=0:this.selectedIndex=Math.min(this.selectedIndex+1,this.suggestions.length-1)),"ArrowUp"===e.key&&(e.preventDefault(),null==this.selectedIndex?this.selectedIndex=this.suggestions.length-1:this.selectedIndex=Math.max(this.selectedIndex-1,0)),this.value=null===(_a=this.suggestions[this.selectedIndex])||void 0===_a?void 0:_a.value,"Enter"===e.key){var selectedItem=this.suggestions[this.selectedIndex];this.value=selectedItem.value,this.inputField.value=selectedItem.label,this.itemSelected.emit(selectedItem.value),this.focused=!1}"Tab"===e.key&&(this.focused=!1)}selectItem(e,index){e.preventDefault(),e.stopPropagation(),this.selectedIndex=index,this.value=this.suggestions[this.selectedIndex].value,this.focused=!1,this.itemSelected.emit(this.suggestions[this.selectedIndex].value)}getVirtualScrollHeight(){return this.findAverageSuggestionHeight()*(this.totalSuggestions-this.suggestions.length)}handleDropdownClick(){this.handleSearchQueryChanged(this.value)}handleSuggestionsScroll(){const container=this.suggestionsContainer,currentScrollTop=container.scrollTop;if(currentScrollTop>this.lastScrollTop){const loadingDiv=container.querySelector(".loading");if(null==loadingDiv)return void(this.lastScrollTop=currentScrollTop);const loadingDivBottom=loadingDiv.offsetTop+loadingDiv.offsetHeight;currentScrollTop+container.clientHeight>loadingDivBottom&&(container.scrollTop=loadingDivBottom-container.clientHeight),this.checkIfMoreItemsNeeded()}this.lastScrollTop=currentScrollTop}checkIfMoreItemsNeeded(){const container=this.suggestionsContainer,loadingDiv=container.querySelector(".loading");if(null==loadingDiv)return;const scrollPosition=container.scrollTop+container.clientHeight;if(loadingDiv.offsetTop-scrollPosition<this.preloadThresholdPixels){const eventArgs={searchTerm:this.inputField.value};this.needMoreItems.emit(eventArgs)}}handleBlur(){this.focused=!1;var validity=this.inputField.checkValidity();this.valid=validity,this.fieldset.setValidity(validity,this.inputField.validationMessage),this.internals.setValidity(this.inputField.validity,this.inputField.validationMessage)}render(){var _a;return(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.H,{key:"d168d544d1cba6e484ada7c7cedce5be58758451",tabIndex:this.focused?-1:0,onFocus:()=>this.inputField.focus(),onBlur:()=>this.inputField.blur()},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("dnn-fieldset",{key:"fb37ca0af0864e4b92b33aae7e5d3814b612c4b7",ref:el=>this.fieldset=el,invalid:!this.valid,focused:this.focused,label:`${null!==(_a=this.label)&&void 0!==_a?_a:""}${this.required?" *":""}`,helpText:this.helpText,id:this.labelId,disabled:this.disabled,floatLabel:this.shouldLabelFloat()},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"b101dbe15914cf744bd6ce6d06b1ac2ce35542c8",class:"inner-container"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("input",{key:"7d8036fcaed65455b8baf35facd70ae309f8439f",ref:el=>this.inputField=el,name:this.name,type:"search",role:"combobox","aria-haspopup":"listbox","aria-expanded":this.focused.toString(),"aria-activedescendant":void 0!==this.selectedIndex?`option-${this.selectedIndex}`:void 0,disabled:this.disabled,required:this.required,autoComplete:"off",value:this.suggestions.length>0&&null!=this.selectedIndex?this.suggestions[this.selectedIndex].label:this.value,onFocus:()=>this.focused=!0,onBlur:()=>this.handleBlur(),onInput:e=>this.handleInput(e),onInvalid:()=>this.handleInvalid(),onChange:()=>this.handleChange(),"aria-labelledby":this.labelId,onKeyDown:e=>this.handleKeyDown(e)}),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("ul",{key:"b91ea7711160c7c0abecb39d687b84f2402294e3",class:this.focused&&this.suggestions.length>0?"show":"",role:"listbox",ref:el=>this.suggestionsContainer=el,onScroll:()=>this.handleSuggestionsScroll()},this.suggestions.map(((suggestion,index)=>(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("li",{id:`option-${index}`,role:"option","aria-selected":this.selectedIndex==index,class:this.selectedIndex==index?"selected":"",onClick:e=>this.selectItem(e,index)},null!=this.renderSuggestion?this.renderSuggestion(suggestion):suggestion.label))),null!=this.totalSuggestions&&this.totalSuggestions>this.suggestions.length&&(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"4be99d7a7a307dc985440f87ee076f9817dd84bb",class:"loading"}),null!=this.totalSuggestions&&this.totalSuggestions>this.suggestions.length&&this.positionInitialized&&(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"36c4e63152c4a5cd48ff9531001e4cbdfaab1047",style:{height:`${this.getVirtualScrollHeight()}px`}})),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg",{key:"070ac24319e8a0beef616bbb1cefb808ac598c4e",onClick:()=>this.handleDropdownClick(),class:"chevron-down",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 -960 960 960"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"53f56ae50d99a3ec830b84a8d92edcf8d41904d1",d:"M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"})))))}static get formAssociated(){return!0}get element(){return(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.g)(this)}};__decorate([(0,_debounce_0977f95e_js__WEBPACK_IMPORTED_MODULE_1__.D)(300)],DnnAutocomplete.prototype,"handleSearchQueryChanged",null),__decorate([(0,_debounce_0977f95e_js__WEBPACK_IMPORTED_MODULE_1__.D)(100)],DnnAutocomplete.prototype,"handleSuggestionsScroll",null),__decorate([(0,_debounce_0977f95e_js__WEBPACK_IMPORTED_MODULE_1__.D)()],DnnAutocomplete.prototype,"checkIfMoreItemsNeeded",null),DnnAutocomplete.style=":host{display:inline-block;--foreground-color:var(--dnn-color-foreground, #000);--background-color:var(--dnn-color-background, #fff);--focus-color:var(--dnn-color-primary, #3792ED);--danger-color:var(--dnn-color-danger, #900);--control-radius:var(--dnn-controls-radius, 3px)}dnn-fieldset{width:100%}@keyframes shift{0%{background-position:0% 0}50%{background-position:100% 0}100%{background-position:200% 0}}.inner-container{display:flex;justify-content:space-between;position:relative;width:100%}.inner-container input{border:none;outline:none;background-color:transparent;color:var(--foreground-color);text-align:var(--input-text-align);width:100%}.inner-container svg.chevron-down{height:1rem;width:auto;transform:scale(1.2);cursor:pointer}.inner-container ul{position:absolute;border:1px solid lightgray;margin:0;padding:var(--dnn-controls-radius, 3px) 0;overflow-y:auto;width:100%;box-shadow:2px 2px 6px 1px rgba(0, 0, 0, 0.3);background-color:var(--dnn-color-background, white);border-radius:var(--dnn-controls-radius, 3px);z-index:2;display:none;scroll-behavior:smooth}.inner-container ul.show{display:block}.inner-container ul li{display:block;list-style-type:none;cursor:pointer;padding:0 0.5rem}.inner-container ul li.selected{background-color:lightgray}.inner-container ul li:hover{background-color:lightgray}.inner-container ul .loading{width:100%;height:0.5rem;border-radius:0.5rem;background:linear-gradient(to right, var(--background-color) 0%, var(--foreground-color) 50%, var(--background-color) 100%);background-size:200% 100%;animation:shift 2s linear infinite;width:75%;margin:0 auto;opacity:0.5}"}}]);