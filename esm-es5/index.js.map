{"version":3,"sources":["src/utilities/dnnServicesFramework.ts"],"names":["DnnServicesFramework","moduleId","_this","this","getServiceRoot","moduleName","serviceRoot","window","top","dnn","getVar","getTabId","tabId","parseInt","getModuleId","_moduleId","getAntiForgeryValue","el","document","querySelector","value","getModuleHeaders","headers","Headers","append","toString","afValue"],"mappings":"sFAgBI,SAAAA,EAAYC,GAAZ,IAAAC,EAAAC,KAIAA,KAAAC,eAAiB,SAACC,GAEd,IAAIC,EAAcC,OAAOC,IAAIC,IAAIC,OAAO,cAAe,KACvDJ,GAAe,OAASD,EAAa,IACrC,OAAOC,GAGXH,KAAAQ,SAAW,WACP,IAAIC,EAAQL,OAAOC,IAAIC,IAAIC,OAAO,WAAY,MAC9C,OAAOG,SAASD,IAGpBT,KAAAW,YAAc,WACV,OAAOZ,EAAKa,WAGhBZ,KAAAa,oBAAsB,WAClB,IAAMC,EAAKC,SAASC,cAAc,0CAClC,GAAIF,GAAM,KAAK,CACX,OAAOA,EAAGG,UAEV,CACA,OAAO,OAIfjB,KAAAkB,iBAAmB,WACf,IAAIC,EAAU,IAAIC,QAClB,GAAIrB,EAAKS,YAAc,EAAE,CACrBW,EAAQE,OAAO,WAAYtB,EAAKa,UAAUU,YAC1CH,EAAQE,OAAO,QAAStB,EAAKS,WAAWc,YAE5C,IAAMC,EAAUxB,EAAKc,sBACrB,GAAIU,GAAW,KAAK,CAChBJ,EAAQE,OAAO,2BAA4BE,GAE/C,OAAOJ,GAvCPnB,KAAKY,UAAYd","sourcesContent":["declare global {\r\n    interface Window {\r\n        dnn: {\r\n            //** Gets dnn variables from the page context *\r\n            getVar: (key: string, defaultValue: string) => string;\r\n        }\r\n    }\r\n}\r\n\r\nexport class DnnServicesFramework{\r\n    \r\n    private _moduleId: number;\r\n\r\n    /**\r\n     * Initializes the serivces framework\r\n     */\r\n    constructor(moduleId: number) {\r\n        this._moduleId = moduleId;\r\n    }\r\n\r\n    getServiceRoot = (moduleName: string) =>\r\n    {\r\n        var serviceRoot = window.top.dnn.getVar(\"sf_siteRoot\", \"/\");\r\n        serviceRoot += \"API/\" + moduleName + \"/\";\r\n        return serviceRoot;\r\n    }\r\n\r\n    getTabId = () => {\r\n        var tabId = window.top.dnn.getVar(\"sf_tabId\", \"-1\");\r\n        return parseInt(tabId);\r\n    }\r\n\r\n    getModuleId = () => {\r\n        return this._moduleId;\r\n    }\r\n\r\n    getAntiForgeryValue = () => {\r\n        const el = document.querySelector(\"input[name=__RequestVerificationToken]\") as HTMLInputElement;\r\n        if (el != null){\r\n            return el.value;\r\n        }\r\n        else{\r\n            return null;\r\n        }\r\n    }\r\n\r\n    getModuleHeaders = () => {\r\n        var headers = new Headers();\r\n        if (this.getTabId() > -1){\r\n            headers.append(\"ModuleId\", this._moduleId.toString());\r\n            headers.append(\"TabId\", this.getTabId().toString());\r\n        }\r\n        const afValue = this.getAntiForgeryValue();\r\n        if (afValue != null){\r\n            headers.append(\"RequestVerificationToken\", afValue);\r\n        }\r\n        return headers;\r\n    }\r\n}"]}