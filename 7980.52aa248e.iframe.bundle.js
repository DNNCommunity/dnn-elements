"use strict";(self.webpackChunk_dnncommunity_dnn_elements=self.webpackChunk_dnncommunity_dnn_elements||[]).push([[7980],{"./dist/esm/dnn-dropzone.entry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{dnn_dropzone:()=>DnnDropzone});var _index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./dist/esm/index-a2e9a98f.js"),_stringUtilities_b220cf3a_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./dist/esm/stringUtilities-b220cf3a.js");const DnnDropzone=class{constructor(hostRef){(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,hostRef),this.filesSelected=(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"filesSelected",7),hostRef.$hostElement$["s-ei"]?this.internals=hostRef.$hostElement$["s-ei"]:(this.internals=hostRef.$hostElement$.attachInternals(),hostRef.$hostElement$["s-ei"]=this.internals),this.defaultResx={dragAndDropFile:"Drag and drop a file",capture:"Capture",or:"or",takePicture:"Take a picture",uploadFile:"Upload a file",uploadSizeTooLarge:"The file you tried to upload is too large.",fileSizeLimit:"The maximum size is {0}",invalidExtension:"The file you tried to upload has an invalid extension.",allowedFileExtensions:"Allowed file extensions: {0}"},this.handleDragOver=event=>{event.stopPropagation(),event.preventDefault(),event.dataTransfer.dropEffect="copy",this.dropzone.classList.add("dropping")},this.handleDrop=dropEvent=>{this.invalidExtension=!1,this.fileTooLarge=!1,dropEvent.stopPropagation(),dropEvent.preventDefault();const files=dropEvent.dataTransfer.files;if(this.hasInvalidExtensions(Array.from(files)))this.invalidExtension=!0;else if(this.isAnyFileLargerThanAllowed(Array.from(files)))this.fileTooLarge=!0;else{var fileList=this.getFilesFromFileList(files);this.filesSelected.emit(fileList)}},this.resx=void 0,this.allowedExtensions=void 0,this.allowCameraMode=!1,this.captureQuality=.8,this.maxFileSize=void 0,this.name=void 0,this.canTakeSnapshots=!1,this.takingPicture=!1,this.fileTooLarge=!1,this.invalidExtension=!1,this.localResx=void 0,this.focused=!1}componentWillLoad(){this.mergeResx()}componentDidLoad(){if(this.allowCameraMode&&this.checkIfBrowserCanTakeSnapshots().then((result=>this.canTakeSnapshots=result)),null!=this.allowedExtensions&&this.allowedExtensions.length>0){var extensionsList=this.allowedExtensions.map((e=>`.${e}`)).join(",");this.fileInput.accept=extensionsList}}resxChanged(){this.mergeResx()}formResetCallback(){this.internals.setValidity({}),this.fileInput.value="",this.internals.setFormValue("")}mergeResx(){this.localResx=Object.assign(Object.assign({},this.defaultResx),this.resx)}checkIfBrowserCanTakeSnapshots(){return new Promise((resolve=>{const mediaDevices=navigator.mediaDevices;null!=mediaDevices&&null!=mediaDevices.enumerateDevices||resolve(!1),mediaDevices.enumerateDevices().then((devices=>{var result=devices.some((device=>"videoinput"==device.kind));resolve(result)}))}))}getFilesFromFileList(files){var fileList=[];for(let index=0;index<files.length;index++){const file=files[index];fileList.push(file)}return fileList}isAnyFileLargerThanAllowed(files){return!(null==this.maxFileSize||this.maxFileSize<=0)&&!!files.some((file=>file.size>this.maxFileSize))}handleUploadKeyDown(event){"Enter"!==event.key&&" "!==event.key||(event.preventDefault(),this.fileInput.click())}handleUploadButton(element){this.fileTooLarge=!1,this.invalidExtension=!1;let files=this.getFilesFromFileList(element.files);if(this.isAnyFileLargerThanAllowed(files))this.fileTooLarge=!0;else if(this.hasInvalidExtensions(files))this.invalidExtension=!0;else if(this.filesSelected.emit(files),null!=this.name&&this.name.length>0){var data=new FormData;files.forEach((file=>{data.append(this.name,file)})),this.internals.setFormValue(data)}}hasInvalidExtensions(files){var _a,_b,hasInvalid=!1;for(let fileIndex=0;fileIndex<files.length;fileIndex++){const file=files[fileIndex];const fileExtension=null===(_a=/(?:\.([^.]+))?$/.exec(file.name)[1])||void 0===_a?void 0:_a.toLowerCase();null==fileExtension&&(hasInvalid=!0);var loweredAllowedExtensions=null===(_b=this.allowedExtensions)||void 0===_b?void 0:_b.map((e=>e.toLowerCase()));return null==this.allowedExtensions||(null==loweredAllowedExtensions?void 0:loweredAllowedExtensions.includes(fileExtension))||(hasInvalid=!0),hasInvalid}}takeSnapshot(){this.takingPicture=!0,navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((stream=>{this.videoPreview.srcObject=stream,this.videoPreview.play().then((()=>{this.videoSettings=stream.getVideoTracks()[0].getSettings()}))})).catch((error=>alert(error)))}applySnapshot(){var canvas=document.createElement("canvas");const context=canvas.getContext("2d");canvas.width=this.videoSettings.width,canvas.height=this.videoSettings.height,context.drawImage(this.videoPreview,0,0),canvas.toBlob((blob=>{var file=new File([blob],"image.jpeg",{type:"image/jpeg"});this.takingPicture=!1;var fileList=[file];this.filesSelected.emit(fileList)}),"image/jpeg",this.captureQuality)}getInvalidExtensionsMessage(){return this.localResx.allowedFileExtensions.replace("{0}",this.allowedExtensions.join(", "))}render(){var _a,_b,_c,_d,_e,_f;return(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.H,{key:"e8cb239b37d1be0f7c41240465cd6a158ab0097b",ref:e=>this.dropzone=e,class:"dropzone",onDragOver:e=>this.handleDragOver(e),onDrop:e=>this.handleDrop(e),onDragLeave:()=>this.dropzone.classList.remove("dropping"),tabIndex:this.focused?-1:0,onFocus:()=>this.uploadLabel.focus(),onBlur:()=>this.uploadLabel.blur()},!this.takingPicture&&[(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"0a6f9cdb3eef3449dc2092cd6ed5d32e431f3c2d"},null===(_a=this.localResx)||void 0===_a?void 0:_a.dragAndDropFile),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"1179185c6fa4615e9f3ad362e7f7b663c80ee8f9"},"- ",null===(_b=this.localResx)||void 0===_b?void 0:_b.or," -"),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("label",{key:"15a2262c638dd5b4b2f5c0d51fb4d361ccdc98cc",class:"upload-file",tabIndex:0,onKeyDown:e=>this.handleUploadKeyDown(e),ref:el=>this.uploadLabel=el,onFocus:()=>this.focused=!0,onBlur:()=>this.focused=!1},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("input",{key:"8890c891d3805213887403528b9e8d8661f81100",type:"file",ref:el=>this.fileInput=el,onChange:e=>this.handleUploadButton(e.target)}),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{key:"e4b5083f873c27f7550f29ee5d6f433a4e79ab58"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg",{key:"3f3d9e3e491ab3159767da319d08b3a07c08a65d",xmlns:"http://www.w3.org/2000/svg","enable-background":"new 0 0 24 24",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("g",{key:"d88531469503abfc3b33940f7f690545a6bd7c47"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("rect",{key:"67cfd319af430b66b2c3c4db9cf043b5ca8b44d2",fill:"none",height:"24",width:"24"})),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("g",{key:"929ff336aa3a765c6b0ae3804af479152f15580e"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"423d42dd1312a6e92e58112c9abb17c9747c5edc",d:"M5,20h14v-2H5V20z M5,10h4v6h6v-6h4l-7-7L5,10z"}))))," ",null===(_c=this.localResx)||void 0===_c?void 0:_c.uploadFile),this.canTakeSnapshots&&[(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"79d4eba604972b765af99a259444017effc430d0"},"- ",null===(_d=this.localResx)||void 0===_d?void 0:_d.or," -"),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("button",{key:"181c7f2c3e0fe10a0e442f671b585d7fd52240e4",onClick:()=>this.takeSnapshot()},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg",{key:"a7895b7adac1558f45ccccc87f449bb2ffec557c",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"23128d601f71f2e8cd8af075fe74de8e7f67e92c",d:"M0 0h24v24H0z",fill:"none"}),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("circle",{key:"a082e32a026bfa4586fe203783cbd585e244f774",cx:"12",cy:"12",r:"3.2"}),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"8f1b6b43558cb3ad0e375b01f71da751d88afea8",d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})),null===(_e=this.localResx)||void 0===_e?void 0:_e.takePicture)]],this.takingPicture&&(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"48ccb4be518d323659462b075f0ee2bf6d7ae052",class:"video-preview"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("video",{key:"26659446b8ac3c291aa89352c19515978e0596f8",ref:e=>this.videoPreview=e}),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("button",{key:"9b7699d716d94611d4b3ae7590a5e76efe4f8b83",onClick:()=>this.applySnapshot()},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg",{key:"5576687f6e6592825ff4d89e12cc8da2cacf7b49",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"fb833f77e4803eb29d6eb68a92e1a9de775c756b",d:"M0 0h24v24H0z",fill:"none"}),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("circle",{key:"0abc995fbda0ce7af15004867d8cced2e153577d",cx:"12",cy:"12",r:"3.2"}),(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"d3045fa3aecc259628598a2ed67c38a7721f1148",d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"}))," ",null===(_f=this.localResx)||void 0===_f?void 0:_f.capture)),this.fileTooLarge&&(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"b66d8d9f21a9948595df5217f9745e8ecc08f779",class:"error"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"080b2779e7656c953d77a4b9719cc4984890ec87"},this.localResx.uploadSizeTooLarge,(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("br",{key:"683ecdcf26529260f25e16988be94a71d570c61f"}),this.localResx.fileSizeLimit.replace("{0}",(0,_stringUtilities_b220cf3a_js__WEBPACK_IMPORTED_MODULE_1__.a)(this.maxFileSize)))),this.invalidExtension&&(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"3b48bf8ba1e235d2f4fb3e2192cf18735dfa35df",class:"error"},(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"c0b42d27ae92e7d38d48fe9ac86c70d9d657b8c7"},this.localResx.invalidExtension,(0,_index_a2e9a98f_js__WEBPACK_IMPORTED_MODULE_0__.h)("br",{key:"1e0995b7bb02db676e56840e5692b36e2ca5191a"}),this.getInvalidExtensionsMessage())))}static get formAssociated(){return!0}static get watchers(){return{resx:["resxChanged"]}}};DnnDropzone.style=":host{--border-color:var(--dnn-color-tertiary-contrast, lightgray);--border-radius:var(--dnn-controls-radius, 5px);--drop-background-color:var(--dnn-color-tertiary, lightblue);display:flex;flex-direction:column;gap:1rem;text-align:center;border:2px dashed var(--border-color);border-radius:var(--border-radius);padding:1rem;transition:all 300ms ease-in-out}:host(.dropping){background-color:var(--drop-background-color)}p{margin:0;padding:0}button{display:flex;justify-content:center;align-items:center;border:0px;margin:0;padding:0;background-color:transparent}button:hover{cursor:pointer}button svg{margin-right:0.5rem}label.upload-file{display:flex;justify-content:center;align-items:center;cursor:pointer}label.upload-file input{display:none}.video-preview{display:flex;flex-direction:column;align-items:center}.video-preview button{margin:1rem}.error{color:red}"},"./dist/esm/stringUtilities-b220cf3a.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function getReadableFileSizeString(fileSizeInBytes){let i=-1;const byteUnits=[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"];if(0===fileSizeInBytes)return`0${byteUnits[0]}`;do{fileSizeInBytes/=1024,i++}while(fileSizeInBytes>1024);return Math.max(fileSizeInBytes,.1).toFixed(1)+byteUnits[i]}function decodeHtml(html){if(!html)return"";const txt=document.createElement("textarea");return txt.innerHTML=html,txt.value}function generateRandomId(length=16){const characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let result="";const array=new Uint8Array(length);window.crypto.getRandomValues(array);for(let i=0;i<length;i++){const randomValue=array[i];result+=characters.charAt(randomValue%62)}return result}__webpack_require__.d(__webpack_exports__,{a:()=>getReadableFileSizeString,d:()=>decodeHtml,g:()=>generateRandomId})}}]);