"use strict";(self.webpackChunk_dnncommunity_dnn_elements=self.webpackChunk_dnncommunity_dnn_elements||[]).push([[7980],{"./dist/esm/dnn-dropzone.entry.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{dnn_dropzone:()=>DnnDropzone});var _index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./dist/esm/index-9dbb7028.js"),_stringUtilities_b220cf3a_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./dist/esm/stringUtilities-b220cf3a.js");const DnnDropzone=class{constructor(hostRef){(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.r)(this,hostRef),this.filesSelected=(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.c)(this,"filesSelected",7),hostRef.$hostElement$["s-ei"]?this.internals=hostRef.$hostElement$["s-ei"]:(this.internals=hostRef.$hostElement$.attachInternals(),hostRef.$hostElement$["s-ei"]=this.internals),this.defaultResx={dragAndDropFile:"Drag and drop a file",capture:"Capture",or:"or",takePicture:"Take a picture",uploadFile:"Upload a file",uploadSizeTooLarge:"The file you tried to upload is too large.",fileSizeLimit:"The maximum size is {0}",invalidExtension:"The file you tried to upload has an invalid extension.",allowedFileExtensions:"Allowed file extensions: {0}"},this.handleDragOver=event=>{event.stopPropagation(),event.preventDefault(),event.dataTransfer.dropEffect="copy",this.dropzone.classList.add("dropping")},this.handleDrop=dropEvent=>{this.invalidExtension=!1,this.fileTooLarge=!1,dropEvent.stopPropagation(),dropEvent.preventDefault();const files=dropEvent.dataTransfer.files;if(this.hasInvalidExtensions(Array.from(files)))this.invalidExtension=!0;else if(this.isAnyFileLargerThanAllowed(Array.from(files)))this.fileTooLarge=!0;else{var fileList=this.getFilesFromFileList(files);this.filesSelected.emit(fileList)}},this.resx=void 0,this.allowedExtensions=void 0,this.allowCameraMode=!1,this.captureQuality=.8,this.maxFileSize=void 0,this.name=void 0,this.canTakeSnapshots=!1,this.takingPicture=!1,this.fileTooLarge=!1,this.invalidExtension=!1,this.localResx=void 0,this.focused=!1}componentWillLoad(){this.mergeResx()}componentDidLoad(){if(this.allowCameraMode&&this.checkIfBrowserCanTakeSnapshots().then((result=>this.canTakeSnapshots=result)),null!=this.allowedExtensions&&this.allowedExtensions.length>0){var extensionsList=this.allowedExtensions.map((e=>`.${e}`)).join(",");this.fileInput.accept=extensionsList}}resxChanged(){this.mergeResx()}formResetCallback(){this.internals.setValidity({}),this.fileInput.value="",this.internals.setFormValue("")}mergeResx(){this.localResx=Object.assign(Object.assign({},this.defaultResx),this.resx)}checkIfBrowserCanTakeSnapshots(){return new Promise((resolve=>{const mediaDevices=navigator.mediaDevices;null!=mediaDevices&&null!=mediaDevices.enumerateDevices||resolve(!1),mediaDevices.enumerateDevices().then((devices=>{var result=devices.some((device=>"videoinput"==device.kind));resolve(result)}))}))}getFilesFromFileList(files){var fileList=[];for(let index=0;index<files.length;index++){const file=files[index];fileList.push(file)}return fileList}isAnyFileLargerThanAllowed(files){return!(null==this.maxFileSize||this.maxFileSize<=0)&&!!files.some((file=>file.size>this.maxFileSize))}handleUploadKeyDown(event){"Enter"!==event.key&&" "!==event.key||(event.preventDefault(),this.fileInput.click())}handleUploadButton(element){this.fileTooLarge=!1,this.invalidExtension=!1;let files=this.getFilesFromFileList(element.files);if(this.isAnyFileLargerThanAllowed(files))this.fileTooLarge=!0;else if(this.hasInvalidExtensions(files))this.invalidExtension=!0;else if(this.filesSelected.emit(files),null!=this.name&&this.name.length>0){var data=new FormData;files.forEach((file=>{data.append(this.name,file)})),this.internals.setFormValue(data)}}hasInvalidExtensions(files){var _a,_b,hasInvalid=!1;for(let fileIndex=0;fileIndex<files.length;fileIndex++){const file=files[fileIndex];const fileExtension=null===(_a=/(?:\.([^.]+))?$/.exec(file.name)[1])||void 0===_a?void 0:_a.toLowerCase();null==fileExtension&&(hasInvalid=!0);var loweredAllowedExtensions=null===(_b=this.allowedExtensions)||void 0===_b?void 0:_b.map((e=>e.toLowerCase()));return null==this.allowedExtensions||(null==loweredAllowedExtensions?void 0:loweredAllowedExtensions.includes(fileExtension))||(hasInvalid=!0),hasInvalid}}takeSnapshot(){this.takingPicture=!0,navigator.mediaDevices.getUserMedia({video:!0,audio:!1}).then((stream=>{this.videoPreview.srcObject=stream,this.videoPreview.play().then((()=>{this.videoSettings=stream.getVideoTracks()[0].getSettings()}))})).catch((error=>alert(error)))}applySnapshot(){var canvas=document.createElement("canvas");const context=canvas.getContext("2d");canvas.width=this.videoSettings.width,canvas.height=this.videoSettings.height,context.drawImage(this.videoPreview,0,0),canvas.toBlob((blob=>{var file=new File([blob],"image.jpeg",{type:"image/jpeg"});this.takingPicture=!1;var fileList=[file];this.filesSelected.emit(fileList)}),"image/jpeg",this.captureQuality)}getInvalidExtensionsMessage(){return this.localResx.allowedFileExtensions.replace("{0}",this.allowedExtensions.join(", "))}render(){var _a,_b,_c,_d,_e,_f;return(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)(_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.H,{key:"6608b85ebba7b7314db57d0c49a7171637bdfaed",ref:e=>this.dropzone=e,class:"dropzone",onDragOver:e=>this.handleDragOver(e),onDrop:e=>this.handleDrop(e),onDragLeave:()=>this.dropzone.classList.remove("dropping"),tabIndex:this.focused?-1:0,onFocus:()=>this.uploadLabel.focus(),onBlur:()=>this.uploadLabel.blur()},!this.takingPicture&&[(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"35ab671d7aeeb20544224614971f4ef1a2a0b8cc"},null===(_a=this.localResx)||void 0===_a?void 0:_a.dragAndDropFile),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"c06aea19c7321e0e7dd86d877965c366fb87a0b4"},"- ",null===(_b=this.localResx)||void 0===_b?void 0:_b.or," -"),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("label",{key:"6a0d18aa5dc5d398dc66ab897e338798cc908abf",class:"upload-file",tabIndex:0,onKeyDown:e=>this.handleUploadKeyDown(e),ref:el=>this.uploadLabel=el,onFocus:()=>this.focused=!0,onBlur:()=>this.focused=!1},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("input",{key:"4338b34785c38872f6d6e8138f32910f3aa969e5",type:"file",ref:el=>this.fileInput=el,onChange:e=>this.handleUploadButton(e.target)}),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("span",{key:"e19b2bc369417aea4549b7c4f8cbf5cd82eb5038"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg",{key:"460447b54c87e4e764c730d63d04109649b0e5bd",xmlns:"http://www.w3.org/2000/svg","enable-background":"new 0 0 24 24",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("g",{key:"3e987857304dcb3b00658c5b59c9d71b537827bd"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("rect",{key:"2ef89e26cf62fec520c2c0e28e1dd84ce127e78f",fill:"none",height:"24",width:"24"})),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("g",{key:"c128c63a6474b183071c88146b8f3709c3638ceb"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"491efacd9c0877133074a0899b1d92702c514f34",d:"M5,20h14v-2H5V20z M5,10h4v6h6v-6h4l-7-7L5,10z"}))))," ",null===(_c=this.localResx)||void 0===_c?void 0:_c.uploadFile),this.canTakeSnapshots&&[(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"6105868196fddc2c7276b1768316619236aeb810"},"- ",null===(_d=this.localResx)||void 0===_d?void 0:_d.or," -"),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("button",{key:"fedf250dfb20152576240cdf0f77a61e30809e19",onClick:()=>this.takeSnapshot()},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg",{key:"a8f6f1cb019dd3bb51b97b47e9449a05dac4084a",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"730307ea0b4bcf4ea57e53fa6b47982ca9d8e277",d:"M0 0h24v24H0z",fill:"none"}),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("circle",{key:"b86742f1f09c98cdb755b3f6c07a8c59f92c9132",cx:"12",cy:"12",r:"3.2"}),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"46743718f4d58f109e0ce1a554800e0e77ed3fe8",d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"})),null===(_e=this.localResx)||void 0===_e?void 0:_e.takePicture)]],this.takingPicture&&(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"98089e0d3d6c77c68d22d4f490dfe00d8cf0647a",class:"video-preview"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("video",{key:"badfea495c6b99702403b6ae40f7172efd2657e8",ref:e=>this.videoPreview=e}),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("button",{key:"78401461e485ac9de845fe618d327f18ed82f6fe",onClick:()=>this.applySnapshot()},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("svg",{key:"c6a26b54bf3f16c7430e5fec893b9d0f5d41a5e1",xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#000000"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"c89c76d9f2771f4ed31fc7a7322dc88109257cf2",d:"M0 0h24v24H0z",fill:"none"}),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("circle",{key:"e3136fe39c3d78d3f5a5e176000f277b74fca3b5",cx:"12",cy:"12",r:"3.2"}),(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("path",{key:"65e635efbb337b80974e550e64441e7d7c97fa22",d:"M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"}))," ",null===(_f=this.localResx)||void 0===_f?void 0:_f.capture)),this.fileTooLarge&&(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"cbb7a4576bf76aed41393768d52fec1ac55de96d",class:"error"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"e4e287d4a6ffcf8efff38f8de3c2091e24549733"},this.localResx.uploadSizeTooLarge,(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("br",{key:"9b7e2d741f1e5a99f4f8ff30081832ae03b0720e"}),this.localResx.fileSizeLimit.replace("{0}",(0,_stringUtilities_b220cf3a_js__WEBPACK_IMPORTED_MODULE_1__.a)(this.maxFileSize)))),this.invalidExtension&&(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("div",{key:"5c1d76222475b94ce5fcd2519db9d5ffa56b983e",class:"error"},(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("p",{key:"31b4dbc1e612db9634061acc4abd4390be401f28"},this.localResx.invalidExtension,(0,_index_9dbb7028_js__WEBPACK_IMPORTED_MODULE_0__.h)("br",{key:"87a3bea37f1252b347747fbd00ffeda7822a0db6"}),this.getInvalidExtensionsMessage())))}static get formAssociated(){return!0}static get watchers(){return{resx:["resxChanged"]}}};DnnDropzone.style=":host{--border-color:var(--dnn-color-tertiary-contrast, lightgray);--border-radius:var(--dnn-controls-radius, 5px);--drop-background-color:var(--dnn-color-tertiary, lightblue);display:flex;flex-direction:column;gap:1rem;text-align:center;border:2px dashed var(--border-color);border-radius:var(--border-radius);padding:1rem;transition:all 300ms ease-in-out}:host(.dropping){background-color:var(--drop-background-color)}p{margin:0;padding:0}button{display:flex;justify-content:center;align-items:center;border:0px;margin:0;padding:0;background-color:transparent}button:hover{cursor:pointer}button svg{margin-right:0.5rem}label.upload-file{display:flex;justify-content:center;align-items:center;cursor:pointer}label.upload-file input{display:none}.video-preview{display:flex;flex-direction:column;align-items:center}.video-preview button{margin:1rem}.error{color:red}"},"./dist/esm/stringUtilities-b220cf3a.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{function getReadableFileSizeString(fileSizeInBytes){let i=-1;const byteUnits=[" kB"," MB"," GB"," TB","PB","EB","ZB","YB"];if(0===fileSizeInBytes)return`0${byteUnits[0]}`;do{fileSizeInBytes/=1024,i++}while(fileSizeInBytes>1024);return Math.max(fileSizeInBytes,.1).toFixed(1)+byteUnits[i]}function decodeHtml(html){if(!html)return"";const txt=document.createElement("textarea");return txt.innerHTML=html,txt.value}function generateRandomId(length=16){const characters="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";let result="";const array=new Uint8Array(length);window.crypto.getRandomValues(array);for(let i=0;i<length;i++){const randomValue=array[i];result+=characters.charAt(randomValue%62)}return result}__webpack_require__.d(__webpack_exports__,{a:()=>getReadableFileSizeString,d:()=>decodeHtml,g:()=>generateRandomId})}}]);